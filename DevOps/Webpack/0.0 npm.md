# npm

## 유의적 버전

> 출처 : https://jeonghwan-kim.github.io/series/2019/12/09/frontend-dev-env-npm.html#54-%EC%9C%A0%EC%9D%98%EC%A0%81-%EB%B2%84%EC%A0%84

`^16.12.0` 이 표기는 무슨 뜻일까?

프로젝트 패키지의 버전을 엄격하게 제한한다면 프로젝트를 버전업 하는데 꽤 힘들 수 있다. 사용하는 패키지를 전부 버전 업 해야하기 때문이다. 그렇게 되면 프로젝트는 현재 버전에 갖혀 버릴지도 모른다.

패키지 버전을 느슨하게 풀어놓으면 문제가 해결되나? 오히려 여러 버전별로 코드를 관리해야하는 혼란스러움을 겪게 될 수 있다.

버전 번호를 관리하기 위한 규칙이 필요한데 이 체계를 '**유의적 버전**'이라고 함. npm은 이 유의적 버전(Sementic Version)을 따르는 전제 아래 패키지 버전을 관리한다.

유의적 버전은 주(Major), 부(Minor), 수(Patch) 세 가지 숫자를 조합해서 버전을 관리한다. 위에 설치한 버전은 주 버전이 16, 부 버전이 12, 수 버전이 0이다.

각 버전은 변경하는 기준은 다음과 같다.

- 주 버전(Major Version) : 기존 버전과 호환되지 않게 변경한 경우
- 부 버전(Minor Version) : 기존 버전과 호환되면서 기능이 추가된 경우
- 수 버전(Patch Version) : 기존 버전과 호환되면서 버그를 수정한 경우

<br/>

## 버전의 범위

npm이 버전을 관리하는 방식은 유의적 버전 명세 뿐 아니라 버전의 범위를 자신만의 규칙으로 관리한다. 가장 단순한 것이 특정 버전을 사용하는 경우다.

```js
1.2.3
```

특정 버전보다 높거나 낮을 경우는 다음과 같이 명시한다.

```js
>1.2.3
>=1.2.3
<1.2.3
<=1.2.3
```

마지막으로 틸트(~)와 캐럿(^)을 이용해 범위를 병시한다.

```js
~1.2.3
^1.2.3
```

`틸트(~)` 는 마이너 버전이 명시되어 있으면 패치 버전을 변경한다. 예를 들어 ~1.2.3 표기는 1.2.3 부터 1.3.0 미만까지를 포함한다. 마이너 버전이 없으면 마이너 버전을 갱신한다. ~0 표기는 0.0.0부터 1.0.0 미만 까지를 포함한다.

`캐럿(^)` 은 정식버전에서 마이너와 패치 버전을 변경한다. 예를 들어 ^1.2.3 표기는 1.2.3부터 2.0.0 미만 까지를 포함한다. 정식버전 미만인 0.x 버전은 패치만 갱신한다. ^0 표기는 0.0.0부터 0.1.0 미만 까지를 포함한다.

보통 라이브러리 정식 릴리즈 전에는 패키지 버전이 수시로 변한다. 0.1에서 0.2로 부버전이 변하더라도 하위 호환성을 지키지 않고 배포하는 경우가 빈번하다. ~0로 버전 범위를 표기한다면 0.0.0부터 1.0.0미만까지 사용하기 때문에 하위 호완성을 지키지 못하는 0.2로도 업데이트 되어버리는 문제가 생길수 있다.

반면 캐럿을 사용해 ^0.0으로 표기한다면 0.0.0부터 0.1.0 미만 내에서만 버전을 사용하도록 제한한다. 따라서 하위 호완성을 유지할 수 있다. (자세한 내용은 [여기](https://blog.outsider.ne.kr/1041)를 참고)

NPM으로 패키지를 설치하면 package.json에 설치한 버전을 기록하는데 캐럿 방식을 이용한다. 초기에는 버전 범위에 틸트를 사용하다가 캐럿을 도입해서 기본 동작으로 사용했다. 그래서 우리가 설치한 react는 ^16.12.0 표기로 버전 범위를 기록한 것이다.