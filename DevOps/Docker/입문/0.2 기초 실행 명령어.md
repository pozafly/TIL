# 기초 실행 명령어

```sh
docker run --name webserver -d -p 80:80 nginx
```

- `docker run`: 해당 이미지가 없다면 docker hub 에서 이미지를 다운로드 받고 docker start 한다.
- `--name webserver`: 이미지를 컨테이너에 올릴 때 webserver라는 이름으로 띄울것
- `-d`: 백그라운드에서 실행
- `-p`: 포트포워딩할 포트 번호. 앞에 것이 호스트 환경의 포트고, 뒤에 것이 container 내부의 포트임.
- `nginx`: 이미지 명

```sh
docker ps -a | docker ps
```

- 컨테이너 상태 확인. `-a` 붙이면 실행중이지 않은 것도 확인가능

```sh
docker stop webserver
```

- webserver 이름을 가진 container를 중시시킴

## 이미지

### 다운로드

```sh
# docker pull 이미지명:태그명
$ docker pull nginx:stable-perl
```

- nginx 이미지를 다운로드 받음

### 확인

```sh
docker images | docker image ls
```

- 다운로드 된 이미지 확인하기

### 이미지 삭제

```sh
docker image rm [이미지 ID 또는 이미지명]
```

- 컨테이너에서 사용하고 있지 않은 이미지만 삭제가 가능하다.
- 단, `-f` 를 붙이면 강제로 삭제 가능

## 컨테이너

### 생성

```sh
# docker create 이미지명[:태그명]
$ docker create nginx
```

- 컨테이너를 생성만 하고 실행시키지는 않음.

### 실행

```sh
# docker start 컨테이너명[또는 컨테이너 ID]
$ docker start 컨테이너명[또는 컨테이너 ID]
$ docker ps # 실행중인 컨테이너 조회

# Nginx 컨테이너 중단 후 삭제하기
$ docker ps # 실행 중인 컨테이너 조회
$ docker stop {nginx를 실행시킨 Contnainer ID} # 컨테이너 중단
$ docker rm {nginx를 실행시킨 Contnainer ID} # 컨테이너 삭제
$ docker image rm nginx # Nginx 이미지 삭제
```

### 생성 + 실행

```sh
# docker run 이미지명[:태그명]
$ docker run nginx # 포그라운드에서 실행 (추가적인 명령어 조작을 할 수가 없음)
```

- 로컬 환경에 다운받은 이미지가 없다면 Dockerhub으로부터 이미지를 다운(docker pull)받아서 실행시킨다.
- dockerhub으로부터 **새롭게 갱신 된 이미지를 다운** 받고 싶다면 docker pull 명령어를 활용해야 한다.

> - **포그라운드**는 **내가** **실행시킨** **프로그램의** **내용이** **화면에서** **실행되고** **출력되는** **상태**를 뜻한다. 그러다보니 포그라운드 상태에서는 다른 프로그램을 작할 수가 없다.
> - **백그라운드**는 **내가** **실행시킨** **프로그램이** **컴퓨터** **내부적으로** **실행되는** **상태**를 의미한다. 그래서 프로그램이 어떻게 실행되고 있는지에 대한 정보를 화면에서 확인할 수 없다. 이런 특성 때문에 다른 명령어를 추가로 입력할 수도 있고, 새로운 프로그램을 조작할 수 도 있다.

```sh
# docker run -d 이미지명[:태그명]
$ docker run -d nginx
```

### 컨테이너에 이름 붙여서 생성 및 실행하기

```sh
# docker run -d --name [컨테이너 이름] 이미지명[:태그명]
$ docker run -d --name my-web-server nginx
```

### 호스트의 포트와 컨테이너의 포트를 연결하기

```sh
# docker run -d -p [호스트 포트]:[컨테이너 포트] 이미지명[:태그명]
$ docker run -d -p 4000:80 nginx
```

<img width="817" height="433" alt="Image" src="https://github.com/user-attachments/assets/7197ef72-3fb5-434e-88b1-a0e41fd01d95" />

### 중지

```sh
$ docker stop 컨테이너명[또는 컨테이너 ID]
$ docker kill 컨테이너명[또는 컨테이너 ID]
```

- 차이는 stop은 정상적으로 종료
- kill은 무식하게 강제 종료임
	- 파일이 날라갈 수도 있음.

### 삭제

```sh
$ docker rm 컨테이너명[또는 컨테이너 ID]
```

#### 실행되고 있는 특정 컨테이너 삭제

```sh
$ docker rm -f 컨테이너명[또는 컨테이너 ID]
```

#### 중지되어 있는 모든 컨테이너 삭제

```sh
$ docker rm $(docker ps -qa)
```

#### 실행되고 있는 모든 컨테이너 삭제

```sh
$ docker rm -f $(docker ps -qa)
```

### 로그 조회

#### 특정 컨테이너의 모든 로그조회

```sh
# docker logs [컨테이너 ID 또는 컨테이너명]

$ docker run -d nginx
$ docker logs [nginx가 실행되고 있는 컨테이너 ID]
```

#### 최근 로그 10줄만조회

```sh
# dokcer logs --tail [로그 끝부터 표시할 줄 수] [컨테이너 ID 또는 컨테이너명]
$ dokcer logs --tail 10 [컨테이너 ID 또는 컨테이너명]
```

#### 기존 로그조회 + 생성되는 로그를 실시간으로 보고 싶은 경우

```sh
# docker logs -f [컨테이너 ID 또는 컨테이너명]

# Nginx의 컨테이너에 실시간으로 쌓이는 로그 확인하기
$ docker run -d -p 80:80 nginx
$ docker logs -f
```

- `-f`: follow의 약어

#### 기존 로그는 조회하지 않기 + 생성되는 로그를 실시간으로 보고 싶은 경우

```sh
$ docker logs --tail 0 -f [컨테이너 ID 또는 컨테이너명]
```

## 컨테이너 내부 접속

```sh
# docker exec -it 컨테이너명[또는 컨테이너 ID] bash

$ docker run -d nginx
$ docker exec -it [Nginx가 실행되고 있는 컨테이너 ID] bash
$ ls # 컨테이너 내부 파일 조회
$ cd /etc/nginx
$ cat nginx.conf
```

컨테이너 내부에서 나오려면 Ctrl + D 또는 exit 을 입력하면 된다.
- `bash`: 쉘(Shell)의 일종
- `-it`: -it 옵션을 사용해야 명령어를 입력하고 결과를 확인할 수 있다. -it 옵션을 적지 않으면 명령어를 1번만 실행시키고 종료되어 버린다. 즉, `-it` 옵션을 적어야 계속해서 명령어를 입력할 수 있다.
