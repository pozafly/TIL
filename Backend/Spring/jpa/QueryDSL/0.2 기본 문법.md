# ê¸°ë³¸ ë¬¸ë²•

## Querydsl vs JPQL

```java
@Test
public void startJPQL() {
	//member1ì„ ì°¾ì•„ë¼.
	String qlString = 
			"select m from Member m " +
			"where m.username = :username";
	
	Member findMember = em.createQuery(qlString, Member.class)
			.setParameter("username", "member1").getSingleResult();
	
	assertThat(findMember.getUsername()).isEqualTo("member1");
}

@Test
public void startQuerydsl() {
	//member1ì„ ì°¾ì•„ë¼.
	JPAQueryFactory queryFactory = new JPAQueryFactory(em);
	QMember m = new QMember("m");
	
	Member findMember = queryFactory
			.select(m)
			.from(m)
			.where(m.username.eq("member1"))//íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì²˜ë¦¬
			.fetchOne();
			
	assertThat(findMember.getUsername()).isEqualTo("member1");
}
```

- `EntityManager` ë¡œ `JPAQueryFactory` ìƒì„±
- Querydslì€ JPQL ë¹Œë”
- JPQL: ë¬¸ì(ì‹¤í–‰ ì‹œì  ì˜¤ë¥˜), Querydsl: ì½”ë“œ(ì»´íŒŒì¼ ì‹œì  ì˜¤ë¥˜)
- JPQL: íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ì§ì ‘, Querydsl: íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ìë™ ì²˜ë¦¬

## JPAQueryFactoryë¥¼ í•„ë“œë¡œ

```java
@SpringBootTest
@Transactional
public class QuerydslBasicTest {

	@PersistenceContext
	EntityManager em;
	JPAQueryFactory queryFactory;
	
	@BeforeEach
	public void before() {
		queryFactory = new JPAQueryFactory(em);
		//â€¦
	}
	
	@Test
	public void startQuerydsl2() {
		//member1ì„ ì°¾ì•„ë¼.
		QMember m = new QMember("m");
		
		Member findMember = queryFactory
				.select(m)
				.from(m)
				.where(m.username.eq("member1"))
				.fetchOne();
				
		assertThat(findMember.getUsername()).isEqualTo("member1");
	}
}
```

### ğŸ“Œ ë™ì‹œì„± ë¬¸ì œ

JPAQueryFactoryë¥¼ í•„ë“œë¡œ ì œê³µí•˜ë©´ ë™ì‹œì„± ë¬¸ì œëŠ” ì–´ë–»ê²Œ ë ê¹Œ?

ë™ì‹œì„± ë¬¸ì œëŠ” JPAQueryFactoryë¥¼ ìƒì„±í•  ë•Œ ì œê³µí•˜ëŠ” `EntityManager(em)`ì— ë‹¬ë ¤ìˆìŒ.
ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ëŠ” ì—¬ëŸ¬ ì“°ë ˆë“œì—ì„œ ë™ì‹œì— ê°™ì€ EntityManagerì— ì ‘ê·¼í•´ë„, íŠ¸ëœì­ì…˜ ë§ˆë‹¤ ë³„ë„ì˜ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì œê³µí•˜ê¸° ë•Œë¬¸ì—, ë™ì‹œì„± ë¬¸ì œëŠ” ê±±ì •í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

## Q-Type

### Qí´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” 2ê°€ì§€ ë°©ë²•

```java
QMember qMember = new QMember("m"); //ë³„ì¹­ ì§ì ‘ ì§€ì •
QMember qMember = QMember.member; //ê¸°ë³¸ ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš©
```

> ğŸ“Œ ì°¸ê³ : ê°™ì€ í…Œì´ë¸”ì„ ì¡°ì¸í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ì•„ë‹ˆë©´ ê¸°ë³¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì.

### ê¸°ë³¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ static importì™€ í•¨ê»˜ ì‚¬ìš©

```java
import static study.querydsl.entity.QMember.*;

@Test
public void startQuerydsl3() {
	//member1ì„ ì°¾ì•„ë¼.
	Member findMember = queryFactory
			.select(member)
			.from(member)
			.where(member.username.eq("member1"))
			.fetchOne();

	assertThat(findMember.getUsername()).isEqualTo("member1");
}
```

ë‹¤ìŒ ì„¤ì •ì„ ì¶”ê°€í•˜ë©´ ì‹¤í–‰ë˜ëŠ” JPQLì„ ë³¼ ìˆ˜ ìˆë‹¤.

```properties
spring.jpa.properties.hibernate.use_sql_comments: true
```

ğŸ“Œ í•˜ì§€ë§Œ, p6spyë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ `use_sql_comments`ë¥¼ ì“°ëŠ” ìˆœê°„, ê°’ ë°”ì¸ë”©ì´ `null` ë¡œ ì¹˜í™˜ë˜ì–´ ì œëŒ€ë¡œ ëœ logë¥¼ ë³¼ ìˆ˜ ì—†ìŒ. ì™œëƒë©´ p6spyëŠ” `?` ë¬¸êµ¬ë¥¼ ê°’ìœ¼ë¡œ ì¹˜í™˜í•˜ëŠ”ë° `?` ë¥¼ use_sql_commentsê°€ ì—†ì• ë²„ë¦¬ê¸° ë•Œë¬¸ì„. ë”°ë¼ì„œ use_sql_commentsë¥¼`false` ë¡œ ë‘ê³  ì‚¬ìš©í•˜ì.
