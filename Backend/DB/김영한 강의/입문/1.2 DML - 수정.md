# DML - 수정

## UPDATE 문법

```sql
UPDATE table_name
SET column1 = value1, column2 = value2, …
WHERE condition;
```

- `table_name`: 데이터를 수정할 테이블의 이름.
- `SET column1 = value1, …`: 수정할 열과 새로운 값. 쉼표(,)를 사용해 여러 열을 한 번에 수정.
- `WHERE condition`: 수정할 행을 식별하는 조건. 이 부분을 생략하면 테이블의 모든 행이 수정되므로 극도로 주의해야 함.

## SQL 안전 업데이트 모드

만약 "베이직 반팔 티셔츠" 상품만 특가로 판매하기 위해 가격을 990원으로 변경하려고 했는데, 실수로 WHERE를 생략한다면 어떻게 될까?

```sql
UPDATE products
SET price = 990; -- WHERE product_id = 1; -- 실수로 생략
```

```
Error Code: 1175. You are using safe update mode and you tried to update a table without a WHERE that uses a KEY column. To disable safe mode, toggle the option in Preferences -> SQL Editor and reconnect.
```

다행히 실행되지 않고 오류 발생.

```sql
SELECT @@SQL_SAFE_UPDATES;
```

**실행 결과**: 1
- 실행 결과 1은 안전 업데이트 모드가 활성화 상태이고
- 0은 비활성화 상태.

안전 업데이트 모드 활성화 상태에서는 데이터를 **변경하거나 삭제**할 때 WHERE 절에 기본 키 컬럼을 반드시 지정해야 함. (또는 `LIMIT` 를 사용해서 변경하거나 삭제할 데이터의 양을 조절해야 함)

그래서 기본 키 컬럼을 사용하지 않은 다음과 같은 SQL도 실행이 되지 않음.

```sql
UPDATE products
SET price = 990
WHERE name = '베이직 반팔 티셔츠'; -- name 컬럼을 사용했다.
```

- MySQL이 제공하는 안전 업데이트 모드의 기본 설정은 비활성화(0) 상태.
- **그런데 `MySQL 워크벤치`는 이런 실수를 방지하기 위해 MySQL에 접근할 때 안전 업데이트 설정을 활성화 한다.**

정리하면 다음과 같다.
- **MySQL 서버 (전역):** 기본적으로 OFF (0)
  **애플리케이션 (커넥션):** 기본적으로 OFF (0)
- **MySQL 워크벤치:** 기본적으로 ON (1)

```sql
SET SQL_SAFE_UPDATES = 0; -- 안전 업데이트 모드 끄기
SET SQL_SAFE_UPDATES = 1; -- 안전 업데이트 모드 활성화
```

> 📌 실무에서는 SQL을 사용해서 데이터를 변경하거나 삭제할 때, 반드시 SELECT 쿼리를 먼저 수행.
