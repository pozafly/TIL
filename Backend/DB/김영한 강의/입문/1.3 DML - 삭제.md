# DML - 삭제

## DELETE 문법

DELETE 문의 기본 문법은 다음과 같다.

```sql
DELETE FROM table_name
WHERE condition;
```

- `table_name`: 데이터를 삭제할 테이블의 이름.
- `WHERE condition`: 삭제할 행을 식별하는 조건이다. UPDATE와 마찬가지로 이 부분을 생략하면 테이블의 모든 데이터가 삭제되는 재앙이 발생하므로 반드시 작성.

## `WHERE` 절의 절대적인 중요성

`UPDATE` 는 데이터를 잘못 바꿔도 원래 값을 추적할 여지라도 있지만, `DELETE` 는 행 자체를 없애버린다. `DELETE` 문에서 `WHERE` 절을 빠뜨리는 것은 **핵폭탄 발사 버튼을 누르는 것과 같음.**

### 전체 `UPDATE`, `DELETE` 를 실행했을 때 벌어지는 끔찍한 상황과 대처법

1. **사고 발생**: `WHERE` 절 없는 `UPDATE` 를 실행했다는 사실을 깨닫는다.
2. **즉시 보고 및 서비스 점검**: 즉시 DBA를 호출하고, 상급자에게 상황을 보고. 가능하다면 추가적인 피해를 막기 위해 서비스를 점검 상태로 전환한다. 전문적인 지식을 갖춘 DBA가 있다면 데이터베이스 복원 기능으로 빠르게 복구할 수도 있다.
3. **백업 확인**: 가장 먼저 확인해야 할 것은 가장 최근의 데이터베이스 백업이다. 정기적인 백업이 있었다면, 백업 시점 이후의 데이터 유실을 감수하고 복구(Restore)를 진행할 수 있다. 이것이 백업이 중요한 이유.
4. **로그 분석**: 백업이 없다면, 데이터베이스 로그를 분석하여 변경 이전의 값을 추적하는 복잡한 작업을 시도해 볼 수 있으나, 이는 매우 어렵고 시간이 오래 걸린다.

### 다시 한번 비교하기: DELETE vs TRUNCATE

| 구분               | `DELETE FROM table;`                  | `TRUNCATE TABLE table;`         |
| ---------------- | ------------------------------------- | ------------------------------- |
| 종류               | DML (데이터 조작어)                         | DDL (데이터 정의어)                   |
| 처리 방식            | 한 줄씩, 조건에 따라 삭제 가능<br>(`WHERE` 사용 가능) | 테이블 전체를 한 번에 삭제 (`WHERE` 사용 불가) |
| 속도               | 느림 (각 행의 삭제를 기록)                      | 매우 빠름 (테이블을 잘라내고 새로 만드는 개념)     |
| `AUTO_INCREMENT` | 초기화되지 않음                              | 1부터 다시 시작하도록 초기화됨               |
| 되돌리기(Rollback)   | 트랜잭션 내에서 `ROLLBACK` 가능                | `ROLLBACK` 불가능 (즉시 적용)          |

**언제 무엇을 써야 할까?**
- "탈퇴한 회원 한 명의 정보만 지우고 싶다" 또는 "특정 조건에 맞는 주문 기록만 삭제하고 싶다" 와 같이 **선별적인 삭제**가 필요할 때는 `DELETE` 를 사용해야 한다. 일반적인 비즈니스 로직은 항상 `DELETE` 를 사용한다.
- "테스트용으로 넣었던 수백만 건의 데이터를 모두 지우고 처음부터 다시 시작하고 싶다" 와 같이 **테이블의 모든 데이터를 깨끗하게 비울 목적**이라면 `TRUNCATE` 가 훨씬 빠르고 효율적인 선택이다.
