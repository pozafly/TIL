# Join

## join ì˜ë¯¸

- ë‘ ê°œ ì´ìƒì˜ table ë“¤ì— ìˆëŠ” ë°ì´í„°ë¥¼ í•œ ë²ˆì— ì¡°íšŒí•˜ëŠ” ê²ƒ

## implicit join vs explicit join

idê°€ 1ì¸ ì‚¬ëŒì˜ ë¶€ì„œ ì´ë¦„ì€?
```sql
SELECT d.name
FROM employee e, department d
WHERE e.id = 1 AND e.dept_id = d.id;
```
- **implicit join(ì•”ë¬µì )**: from ì ˆì—ëŠ” tableë§Œ ë‚˜ì—´í•˜ê³  whereì ˆì— join conditionì„ ëª…ì‹œí•˜ëŠ” ë°©ë²•
- ì˜¤ë˜ëœ ìŠ¤íƒ€ì¼
- ê°€ë…ì„±ì´ ë–¨ì–´ì§
- ë³µì¡í•œ join ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ë‹¤ ë³´ë©´ ì‹¤ìˆ˜ë¡œ ì˜ëª»ëœ ì¿¼ë¦¬ë¥¼ ì‘ì„±
```sql
SELECT d.name
FROM employee e JOIN department d ON e.dept_id = d.id
WHERE e.id = 1;
```
- **explicit join(ëª…ì‹œì )**: from ì ˆì— join í‚¤ì›Œë“œì™€ í•¨ê»˜ joined tableì„ ëª…ì‹œí•˜ëŠ” ë°©ì‹
- onì ˆ ë’¤ì— join condition ëª…ì‹œ
- ê°€ë…ì„±ì´ ì¢‹ìŒ
- ë³µì¡í•œ join ì¿¼ë¦¬ ì‘ì„± ì¤‘ ì‹¤ìˆ˜í•  ê°€ëŠ¥ì„± ì¤„ì–´ë“¦

## inner join vs outer join

ê·¸ëƒ¥ `join` ì€ `inner join` ì„.

- **inner join**: ë‘ í…Œì´ë¸”ì—ì„œ join ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” tuple ë“¤ë¡œ result tableì„ ë§Œë“œëŠ” join
- `FROM table1 [INNER] JOIN table2 ON join_condition;`
- join ì¡°ê±´ì— ì‚¬ìš© ê°€ëŠ¥ ì—°ì‚°ì: `=`, `<`, `>`, `!=` ë“±
- join conditionì—ì„œ null ê°’ì„ ê°€ì§€ëŠ” tupleì€ result tableì— í¬í•¨ë˜ì§€ ì•ŠìŒ.

---

- **outer join**: ë‘ í…Œì´ë¸”ì—ì„œ join ì¡°ê±´ì„ ë§Œì¡±í•˜ì§€ ì•ŠëŠ” tupleë“¤ë„ result tableì— í¬í•¨
- `FROM table1 LEFT [OUTER] JOIN table2 ON join_condition;`
- `FROM table1 RIGHT [OUTER] JOIN table2 ON join_condition;`
- `FROM table1 FULL [OUTER] JOIN table2 ON join_condition;`
- join ì¡°ê±´ì— ì‚¬ìš© ê°€ëŠ¥ ì—°ì‚°ì: `=`, `<`, `>`, `!=` ë“±

**department í…Œì´ë¸”**
![[assets/images/de8b9a57ba7a9ed08814177e24e3e64f_MD5.png]]
**employee í…Œì´ë¸”**

![[assets/images/2ed4a2001768ba51084715b424bbeb87_MD5.png]]

### left outer join

ì™¼ìª½ì— ì íŒ tableì˜ null ê°’ë„ í¬í•¨í•œë‹¤.
```sql
SELECT *
FROM employee e LEFT OUTER JOIN department d ON e.dept_id = d.id;
```
![[assets/images/e4a2fdc542dd3fef2b92749dd1ffd368_MD5.png]]
SIMONì˜ dept_idê°€ null ì´ì—ˆëŠ”ë°ë„ í•¨ê»˜ í‘œí˜„ì´ ë˜ì—ˆìŒ.

### right outer join

ì˜¤ë¥¸ìª½ì— ì íŒ tableì˜ null ê°’ë„ í¬í•¨.
```sql
SELECT *
FROM employee e RIGHT OUTER JOIN department d ON e.dept_id = d.id;
```
![[assets/images/e87786c75ec0b5959362c834d537df48_MD5.png]]
HRë„ í¬í•¨ì´ ë˜ì—ˆìŒ.

### full outer join

MySQLì—ì„œëŠ” full outer joinì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ. ëŒ€ì‹  PostgreSQLì—ì„œ ì‹¤í–‰.
```sql
SELECT *
FROM employee e FULL OUTER JOIN department d ON e.dept_id = d.id;
```
![[assets/images/7792ccaa629852e94b9d15397cc906cf_MD5.png]]

ì–‘ìª½ ëª¨ë‘ null ê°’ì„ í¬í•¨í•œ í˜•íƒœì˜ tableì´ ë‚˜ì˜´.

## equi join

- join ì¡°ê±´ì—ì„œ = (equality comparator)ë¥¼ ì‚¬ìš©í•˜ëŠ” join
- ë°©ê¸ˆ ìœ„ì—ì„œ ì‚¬ìš©í•œ `=` ì„ ì‚¬ìš©í•œ ì¡°ì¸

## using í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•œ ì¡°ì¸

- ë‘ tableì´ equi join í•  ë•Œ ì¡°ì¸í•˜ëŠ” attributeì˜ ì´ë¦„ì´ ê°™ë‹¤ë©´ `USING` ìœ¼ë¡œ ê°„ë‹¨í•˜ê²Œ ì‘ì„±.
- ê°™ì€ ì´ë¦„ì˜ attributeëŠ” result tableì—ì„œ í•œ ë²ˆë§Œ í‘œì‹œ
- `FROM table1 JOIN table2 USING (attribute);`
```sql
ALTER TABLE department
RENAME COLUMN id TO dept_id;
```
ë¨¼ì € departmentì˜ idë¥¼ dept_idë¡œ ë°”ê¿”ì£¼ì. ë‹¤ì‹œ inner join í•´ë³´ë©´
```sql
SELECT *
FROM employee e JOIN department d ON e.dept_id = d.dept_id;
```
![[assets/images/74919363d9f5f8f4163c551dda65f0e9_MD5.png]]

ì´ë ‡ê²Œ`dept_id` ê°€ ë‘ë²ˆ ì¡´ì¬í•˜ê²Œ ë¨. ì´ ë•Œ `USING` ì„ ì‚¬ìš©í•´ë³´ì.
```sql
SELECT *
FROM employee e JOIN department d USING (dept_id);
```
![[assets/images/3894a2d12247500fa9e8ae9443c800d3_MD5.png]]
ì»¬ëŸ¼ì´ í•œ ë²ˆë§Œ ë‚˜ì˜¤ê³ , ì¡°ì¸ ì‹œ ì´í€„ ì¡°ì¸ìœ¼ë¡œ ì˜ ê°€ì ¸ì™”ìŒ.
ğŸ“Œ ë‹¨, dept_idê°€ ê°€ì¥ ë¨¼ì € ì•ìª½ìœ¼ë¡œ ë‚˜ì˜¤ê²Œ ëœë‹¤.

## natural join

- ë‘ tableì—ì„œ ê°™ì€ ì´ë¦„ì„ ê°€ì§€ëŠ” ëª¨ë“  attribute pairì— ëŒ€í•´ equi joinì„ ìˆ˜í–‰
- join ì¡°ê±´ì„ ë”°ë¡œ ëª…ì‹œí•˜ì§€ ì•ŠìŒ
- `FROM table1 **NATURAL** JOIN table2;`

ì¼ë‹¨ department í…Œì´ë¸”ì—ì„œ name ì¹¼ëŸ¼ì„ dept_nameìœ¼ë¡œ ë³€ê²½í•œë‹¤.
```sql {2}
SELECT *
FROM employee e NATURAL JOIN department d;

SELECT *
FROM employee e JOIN department d USING (dept_id);
```
ì´ëŸ¬ë©´ USING ê³¼ ë™ì¼í•œ ê²°ê³¼ì„.

ë‹¤ì‹œ department í…Œì´ë¸”ì—ì„œ dept_name ì¹¼ëŸ¼ì„ name ìœ¼ë¡œ ì›ë³µí•¨.

![[assets/images/06211b423a153de724b1542c2a21f150_MD5.png]]

ì´ëŸ° ìƒíƒœë‹¤. employee, department ëª¨ë‘ `dept_id`, `name` ì¹¼ëŸ¼ì´ ë‘ ê°œì”© ìˆëŠ” ìƒíƒœì„.

![[assets/images/d624f732bd0bd25f5f1edd8e29c8c153_MD5.png]]

ì´ëŸ° ì•„ë¬´ ê²°ê³¼ ì—†ìŒ.
naturalì„ í’€ì–´ ì¨ë³´ìë©´
```sql
SELECT *
FROM employee e JOIN department d ON e.dept_id = d.dept_id AND e.name = d.name;
```
ì´ë ‡ê²Œ ì¹¼ëŸ¼ ëª…ì´ ê°™ì€ ë…€ì„ë¼ë¦¬ `=` equi ì¡°ì¸ì„ í•˜ê¸° ë•Œë¬¸ì„.

## cross join

- ë‘ tableì˜ tuple pairë¡œ ë§Œë“¤ ìˆ˜ ìˆëŠ” ëª¨ë“  ì¡°í•© (= Cartesian product)ì„ ê²°ê³¼ë¡œ ë°˜í™˜
- join ì¡°ê±´ì´ ì—†ìŒ
- implicit corss join: `FROM table1, table2`
- explicit cross join: `FROM table1 CROSS JOIN table2`
