# WebStorage

> [출처1](https://velog.io/@j901207/WebStorage), [출처2](https://velog.io/@hellozin/%EC%BF%A0%ED%82%A4-%EC%84%B8%EC%85%98-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EC%9B%B9-%EC%8A%A4%ED%86%A0%EB%A6%AC%EC%A7%80)

## 용어 정리

- 쿠키 : 클라이언트 로컬에 저장되는 키와 값 형태의 작은 파일로 통신 시 데이터를 서버로 보냄.
- 세션 : 일정 시간동안 같은 브라우저로부터 들어오는 일련의 요구를 하나의 상태로 보고 그 상태를 유지하는 기술.
- 웹 스토리지 : 서버가 아닌, 클라이언트에 데이터를 저장할 수 있도록 지원하는 HTML5의 새로운 기능.

웹에서 정보를 저장할 수 있는 방법 3가지가 있음. Cookie, LocalStorage, SessionStorage. 스토리지를 알아보기 전 HTTP 프로토콜 특징을 먼저 보자.

## HTTP 프로토콜의 특징

- `비연결지향(Connectionless)` : 클라이언트가 서버에게 Request를 보내고 서버가 클라이언트에게 Response를 보내면 접속을 종료한다.
- `무상태(Stateless)` : 통신이 끝나면 상태 정보를 유지하지 않는다.

즉, 클라이언트의 로그인 정보나 브라우저에서 입력한 값 등이 페이지를 이동할 때마다 초기화 된다. 이런 문제점을 해결하기 위해 데이터 저장에 사용하는 것이 쿠키, 세션 그리고 웹 스토리지 임.

<br/>

## Cookie

이름, 값, 만료시간, 경로 정보가 들어있다. Cookie는 웹 페이지를 받아오는 서버와 항상 통신하며, 그 정보의 크기가 파일당 4kb로 제한되어 있다. 또한 그 기간이 정해져있어 쿠키가 만료되면 해당 정보를 조회할 수 없게 된다.(이 부분은 쿠키의 만료기간을 길게 설정해 해결 가능)

3가지 목적을 위해 사용함.

- 세션 관리 : 서버에 저장해야 할 로그인, 장바구니, 게임 스코어 등의 정보 관리
- 사용자 맞춤 : 사용자가 선호하는 옵션이나 테마 등의 세팅
- 사용자 추적 : 사용자의 행동을 기록하고 분석하는 용도

<br/>

## WebStorage

웹 스토리지란 **브라우저에 정보를 저장하는 공간**으로, 도메인마다 그 공간이 설정되어 있다. `LocalStorage` 와 `SessionStorage` 두 가지로 이루어져 있고, 두 가지 스토리지(Storage)는 데이터의 휘발성에서 차이가 있음.

### 공통점

1. 도메인 단위로 스토리지를 갖게 된다. Root Domain에 따라 Storage를 갖게 되며, 도메인이 바뀌면 그 스토리에 대한 정보도 바뀜.
2. window의 하위 객체로써, Storage를 상속받는다.
3. 쿠키에 비해 큰 용량을 갖고 있다. (모바일 기준 2.5MB, 데스크탑은 5~10MB)

윈도우의 하위 객체로 같은 클래스를 상속받기 때문에, 같은 메서드(Method)를 사용함. 사용법 또한 비슷하고, 데이터를 기록하는 방식도 같음. 

### 차이점

차이점은 **데이터의 보존기간**에서 차이점이 있다.

#### LocalStroage

영구적이다. 해당 도메인에 다시 접속하면 지우지 않는 한 데이터가 반영구적으로 남아있음. 도메인이 다를 경우 로컬 스토리지에 접근할 수 없다.

#### SessionStorage

브라우저 혹은 탭을 종료하면 데이터가 모두 지워짐. 각 세션마다 개별적으로 저장. 즉, 같은 도메인이라도 세션이 다르면 데이터에 접근할 수 없다.

<br/>

## 장 단점

- Cookie
  - 장 : 대부분의 브라우저에서는 지원 됨.
  - 단 : api가 한번 더 호출되므로 서버에 부담증가 / 쿠키 자체의 용량이 적음
- LocalStorage & SessionStorage
  - 장 : 서버에 불필요하게 데이터 저장하지 않음 / 용량이 크다
  - 단 : HTML4만 지원되는 브라우저라면 지원되지 않음

<br/>

## 사용 예시

- 로컬스토리지 : 자동 로그인
- 세션스토리지 : 입력 폼 정보, 비로그인 장바구니
- 쿠키 : 다시 보지 않음 팝업 창

<br/>

## WebStorage 사용법

setItem 메서드를 사용해 데이터를 등록한다. 또는 객체 체이닝으로 값을 넣어주면 됨.

```js
localStorage.setItem('data', 1);
localStorage.data = 1;
```

이렇게 추가하고자 하는 데이터를 key, value 쌍으로 넣어줌. 이 때, 설정된 키에 해당 값이 `String type` 으로 기록 됨. 따라서 배열 혹은 객체 데이터를 추가하기 위해서는 `JSON.Stringify` 를 사용해 해당 데이터를 JSON string으로 변환해 기록해야 함.

getItem 메서드를 이용해 데이터를 읽어올 수 있다.

```js
const data = localStorage.getItem('data');  // 1
const data = localStorage.data;  // 1값이 들어있음.
```

마찬가지로 배열과 객체 데이터를 가져와 사용할 때는 `JSON.parse` 로 파싱해 사용해야 함.