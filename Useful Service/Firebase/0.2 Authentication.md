# Authentication

사용자 인증(로그인) 서비스를 만들어보자. 해당 폴더의 0.1 Firebase setup 부분을 보고 SDK 를 설정하고 시작해야함.

https://firebase.google.com/docs/auth/web/google-signin?authuser=0 여기를 토대로 아래를 작성해 볼것이다.

## 0. Authentication 켜기



<br/>

## 1. auth_service.js

```javascript
import firebase from 'firebase';

class AuthService {
  login(providerName) {
    // const provider = new firebase.auth.GoogleAuthProvider();
    // 원래 문장은 위와 같은데 []를 사용한 이유는 Google뿐 아니라, Github, Facebook 등
    // 다양한 provider가 존재할 수 있으므로 다른 것들을 받겠다는 뜻.
    const authProvider = new firebase.auth[`${providerName}AuthProvider`]();
    return firebase.auth().signInWithPopup(authProvider);
  }
}

export default AuthService;
```

이렇게 auth 객체를 만들어주자.

<br/>

## 2. DI

```jsx
// index.js
...
import AuthService from './service/auth_service';

const authService = new AuthService();   // 여기 싱글톤으로 만들어 줌.
ReactDOM.render(
  <React.StrictMode>
    <App authService={authService} />   // DI
  </React.StrictMode>,
  document.getElementById('root')
);
```

```jsx
// app.jsx
...
import Login from './components/login/login';

function App({ authService }) {   // app에서 props로 전달,
  return <Login authService={authService} />;   // login.jsx로 전달
}

export default App;
```

```jsx
// login.jsx
const Login = ({ authService }) => {...}
```

이렇게 props로 받아서 사용하자. 개발자 도구에 components 탭에 props로 전달한 authService 객체가 있는지 확인해보자.

<img width="501" alt="스크린샷 2021-03-01 오후 5 38 47" src="https://user-images.githubusercontent.com/59427983/109472100-0bc41080-7ab5-11eb-9ca4-5f4d78fddd6f.png">

잘 들어왔네.

<br/>

## 3. Login 함수 만들기

```jsx
// login.jsx

import React from 'react';
import Header from '../header/header';
import Footer from '../footer/footer';

const Login = ({ authService }) => {
  const onLogin = (event) => {
    // 만들어 놓은 login 함수를 쓸텐데, 매개변수로는 button에 선언된 text를 사용할 것임.
    authService //
      .login(event.currentTarget.textContent)
      .then(console.log);
  };
  return (
    <section>
      <Header />
      <section>
        <h1>Login</h1>
        <ul>
          <li>
            <button onClick={onLogin}>Google</button>  // 이곳의 text
          </li>
          <li>
            <button onClick={onLogin}>Github</button>
          </li>
        </ul>
      </section>
      <Footer />
    </section>
  );
};
export default Login;
```

