# ARP(주소 확인 프로토콜)

네트워크 세계에서 주소를 나타내는 것 2가지
- MAC 주소
	- NIC 자체에 설정하는 주소. 데이터 링크 계층
- IP 주소
	- OS에 설정하는 주소. 네트워크 계층

두 주소가 독립적으로 동작하면 데이터링크 계층, 네트워크 계층의 정보가 일치하지 않아 통신이 이루어지지 않음.

이 두 주소를 연결하는 프로토콜이 '**ARP**'(Address Resolution Protocol) - 주소 확인 프로토콜임. 즉, 2.5계층.

<img width="646" height="290" alt="Image" src="https://github.com/user-attachments/assets/3cd57285-f55d-46d0-9043-da6717283e0b" />
데이터 전송 때, 네트워크 계층에서 받은 IP 패킷을 이더넷 프레임으로 캡슐화 해 케이블로 보내야 함.
IP 주소를 받은 것만으로는 이더넷 프레임을 만드는데 필요한 정보가 부족함.
- 발신자 MAC 주소는 자신의 NIC로 알 수 있지만 목적지 MAC 주소는 알 수 없음.
- ARP로 목적지 IP 주소로 MAC 주소를 구함.
- 이를 **주소 확인**이라고 함.

<img width="960" height="289" alt="Image" src="https://github.com/user-attachments/assets/e3e16992-8860-4d4d-8827-e36c4142bcca" />

## ARP 프레임 형식

ARP는 이더넷 헤더의 타입 코드에서 '0x0806'으로 정의. 이더넷 페이로드에 데이터링크 계층과 네트워크 계층 정보를 담아 MAC 주소와 IP를 연결함.

<img width="972" height="307" alt="Image" src="https://github.com/user-attachments/assets/c555bd18-55ea-46b4-9c2d-cac54e0a84df" />

### 하드웨어 유형

- 사용중인 레이어 2 프로토콜을 나타내는 2바이트 필드
- 이더넷의 경우 '0x0001'

### 프로토콜 유형

- 사용중인 레이어 3 프로토콜을 나타내는 2바이트 필드
- IPv4의 경우 '0x0800'

### 하드웨어 주소 크기

- 하드웨어 주소, 즉 MAC 주소의 길이를 바이트 단위로 나타내는 1바이트 필드
- MAC 주소는 48비트 = 6바이트이므로 '6'

### 프로토콜 주소 크기

- 네트워크 계층에서 사용하는 주소, 즉 IP 주소의 길이를 바이트 단위로 나타내는 1바이트
- IPv4의 길이는 32비트 = 4바이트이므로 '4'

### 오퍼레이션 코드(opcode, 동작 코드)

- ARP 프레임의 종류를 나타내는 2바이트 필드
- ARP Request를 나타내는 '1'
- ARP Reply를 나타내는 '2'

### 발신자 MAC 주소/발신자 IP 주소

- 이름 그대로

### 목적지 MAC 주소/목적지 IP 주소

- 처음엔 MAC 주소를 알 수 없으므로 더미 MAC 주소 '00:00:00:00:00:00'을 설정.

### ARP 주소 확인 흐름
