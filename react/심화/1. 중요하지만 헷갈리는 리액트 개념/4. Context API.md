# Context API

많은 수의 하위 컴포넌트로 전달 할 때 속성값을 반복적으로 내려주어야 하는 문제가 생김. 이럴 때 콘텍스트 API 를 사용하면 좋음. 상위 컴포넌트에서 하위에 있는 모든 컴포넌트로 직접 데이터를 전달할 수 있다.

다음 코드는 App 컴포넌트에서 Greeting 컴포넌트로 속성값을 전달한다.

```jsx
function App() {
  return (
    <div>
      <div>상단 메뉴</div>
      <Profile username="hst" />  // 📌 1
      <div>하단 메뉴</div>
    </div>
  );
}

function Profile({ username }) {
  return (
    <div>
      <Greeting username={username} />  // 📌 2
    </div>
  );
}

function Greeting({ username }) {
  return <p>{`${username}님 안녕하세요`}</p>;
}
```

- 📌 1 : 부모 컴포넌트에서 중간에 있는 Profile 컴포넌트로 속성값을 전달한다.
- 📌 2 : Profile 컴포넌트는 username 속성값을 사용하지 않고 기계적으로 전달한다.

<br/>

## Context API 이해하기

Context API를 사용하면 Profile 컴포넌트가 중간에 개입하지 않고도 속성값을 전달할 수 있다. 위 코드를 다시 작성해보자.

```jsx
const UserContext = React.createContext('');  // 📌 1

function App() {
  return (
    <div>
      <UserContext.Provider value="hst">  // 📌 2
        <div>상단 메뉴</div>
        <Profile />
        <div>하단 메뉴</div>
      </UserContext.Provider>
    </div>
  );
}

function Profile() {
  return (
    <div>
      <Greeting />
      {/* ... */}
    </div>
  );
}

function Greeting() {
  return (
    <UserContext.Consumer>  // 📌 3
      {username => <p>{`${username}님 안녕하세요`}</p>}
    </UserContext.Consumer>
  );
}
```

- 📌 1 : `createContext` 함수를 호출하면 콘텍스트 객체가 생성된다. createContext 함수의 구조는 다음과 같다.

  ```js
  React.createContext(defaultValue) => { Provider, Consumer }
  ```

- 📌 2 : 상위 컴포넌트에서는 Provider 컴포넌트를 이용해서 데이터를 전달한다.

- 📌 3 : 하위 컴포넌트에서는 Consumer 컴포넌트를 이용해서 데이터를 사용한다. Consumer 컴포넌트는 데이터를 찾기 위해 상위로 올라가면서 가장 가까운 Provider 컴포넌트를 찾는다. 만약 최상위에 도달할 때까지 Provider 컴포넌트를 찾지 못한다면 기본값이 사용된다. 기본값 덕분에 Provider 컴포넌트가 없어도 되므로, 어렵지 않게 Greeting 컴포넌트의 테스트 코드를 작성할 수 있다.