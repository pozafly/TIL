# state 관리

애플리케이션이 성장함에 따라 state를 구성하는 방법과 컴포넌트 간에 데이터가 흐르는 방식에 대해 보다 의도적인 태도를 취하는 것이 도움이 된다. 불필요하거나 중복된 state는 버그의 일반적인 원인이다. 이 장에서는 state를 잘 구조화하는 방법, state 업데이트 로직을 유지 관리하는 방법, 멀리 떨어져 있는 컴포넌트 간에 state를 공유하는 방법에 대해 알아본다.

## state로 입력에 반응하기

React를 사용하면 코드에서 UI를 직접 수정하지 않는다. 예를 들어, “버튼 비활성화”, “버튼 활성화”, “성공 메시지 표시” 등과 같은 명령을 작성하지 않는다. 대신 컴포넌트의 다양한 시각적 state(`초기 state`, `입력 state`, `성공 state`)별로 표시하려는 UI를 구현한 다음, 사용자 입력에 대한 응답으로 state 변경을 촉발(트리거)한다. 이는 디자이너가 UI에 대해 생각하는 방식과 유사하다.

## state 구조 선택

state를 잘 구조화하면 수정과 디버깅이 편한 컴포넌트와 버그가 끊임없이 발생하는 컴포넌트의 차이를 만들 수 있다. 가장 중요한 원칙은 state에 불필요하거나 중복된 정보를 포함하지 않아야 한다는 것. 쓸데없는 state가 있으면 업데이트하는 것을 잊어버려 버그를 유발하기 쉽다!

## 컴포넌트 간의 state 공유

때로는 두 컴포넌트의 state가 항상 함께 변경되기를 원할 때가 있습니다. 이렇게 하려면 두 컴포넌트에서 state를 제거하고 가장 가까운 공통 부모로 이동한 다음 프로퍼티를 통해 전달하면 된다. 이를 'state 올리기'라고 하며, React 코드를 작성할 때 가장 흔히 하는 작업 중 하나임.

## state 보존 및 재설정

컴포넌트를 다시 렌더링할 때 React는 트리의 어떤 부분을 유지하고 업데이트할지, 어떤 부분을 버리거나 처음부터 다시 생성할지 결정해야 함. 대부분의 경우 React의 자동 동작은 충분히 잘 작동함. 기본적으로 React는 이전에 렌더링된 컴포넌트 트리와 '일치'하는 트리의 부분을 보존함.

기본적으로는 state를 보존해주지만, 의도적으로 초기화시켜줄 필요도 있을 때가 있다.

React를 사용하면 기본 동작을 재정의하고 컴포넌트에 다른 `key`를 전달해 state를 강제로 초기화할 수 있다. 새 데이터(다시 새로운 UI)로 처음부터 다시 만들어야 하는 컴포넌트로 간주해야 한다는 것을 React에게 알려준다.

## state 로직을 reducer로 추출하기 

많은 state 업데이트가 여러 이벤트 핸들러에 분산되어 있는 컴포넌트는 과부하가 걸릴 수 있다. 이러한 경우 컴포넌트 외부의 모든 state 업데이트 로직을 `reducer` 라는 단일 함수로 통합할 수 있다. 이벤트 핸들러는 사용자 `액션`만 지정하기 때문에 간결해진다. 파일 맨 아래에서 reducer 함수는 각 액션에 대한 응답으로 state가 어떻게 업데이트되어야 하는지 지정한다!

-> 이 부분은 아직 잘 모르겠다.

## context로 데이터 깊숙이 전달하기

일반적으로 부모 컴포넌트에서 자식 컴포넌트로 정보를 전달할 때는 props를 통해 전달함. 하지만 일부 prop을 여러 컴포넌트에 전달해야 하거나 여러 컴포넌트에 동일한 정보가 필요한 경우 props 전달이 불편해질 수 있다. context를 사용하면 부모 컴포넌트가 prop을 통해 명시적으로 전달하지 않고도 그 아래 트리의 모든 컴포넌트에서 일부 정보를 사용할 수 있다(아무리 깊어도).

## Reducer와 Context로 확장하기

reducer를 사용하면 컴포넌트의 state 업데이트 로직을 통합할 수 있다. context를 사용하면 다른 컴포넌트에 정보를 깊숙이 전달할 수 있다. reducer와 context를 함께 결합하여 복잡한 화면의 state를 관리할 수 있다.