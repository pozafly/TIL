# vue-test-utils ì„¤ì¹˜

> ì¶œì²˜ : https://heropy.blog/2020/05/20/vue-test-with-jest/, https://joshua1988.github.io/vue-camp/testing/jest-testing.html#jest-%EC%86%8C%EA%B0%9C

vue2 ê¸°ì¤€.

```shell
$ npm i -D jest @vue/test-utils vue-jest jest-serializer-vue babel-jest babel-core@bridge @types/jest
```

- Jest
- @vue/test-utils
- vue-jest
  - vue íŒŒì¼ì„ jestê°€ í•´ì„í•  ìˆ˜ ìˆë„ë¡, JSë¡œ ì»´íŒŒì¼ í•´ì£¼ëŠ” ëª¨ë“ˆ
- jest-serializer-vue
  - ì €ì¥ëœ Jest Snapshotì„ Vueì— ë§ê²Œ ê°œì„ í•˜ê¸° ìœ„í•´ ì‚¬ìš©
- babel-jest
  - JS / JSX íŒŒì¼ì„ Jestê°€ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” JSë¡œ ì»´íŒŒì¼
- babel-core@bridge
  - Babel 6ë²„ì „ê³¼ í˜¸í™˜ì„±ì„ ìœ„í•´ ì„¤ì¹˜. [ê´€ë ¨ ì´ìŠˆ](https://github.com/facebook/jest/issues/6913#issuecomment-417637086) ì¡´ì¬.

ğŸ“Œ ìµœì‹  Nuxtë‚˜, Vue-clië¥¼ ì‚¬ìš©í•œë‹¤ë©´ ì´ë¯¸ ë‚´ë¶€ë„¤ `@babel/core`, `@babel/preset-env` ê°€ í¬í•¨ë˜ì–´ ìˆìŒ. ë”°ë¼ì„œ, `@babel/core` (7ë²„ì „), `@babel/preset-env` (Babelì˜ ì§€ì› ìŠ¤í™ì„ ì§€ì •)ì„ ì¶”ê°€ë¡œ ì„¤ì¹˜í•˜ì…ˆ.



## Jest í™˜ê²½ì„¤ì •

2ê°€ì§€ ë°©ë²•ì´ ì¡´ì¬. `package.json` íŒŒì¼ì— í¬í•¨ or `jest.config.js` íŒŒì¼ì— ì„¤ì •í•˜ëŠ” ë°©ë²•.

jest.config.js íŒŒì¼ì— ì„¤ì •í•´ë³´ì.

```js
module.exports = {
  // íŒŒì¼ í™•ì¥ìë¥¼ ì§€ì •í•˜ì§€ ì•Šì€ ê²½ìš°, Jestê°€ ê²€ìƒ‰í•  í™•ì¥ì ëª©ë¡ì…ë‹ˆë‹¤.
  // ì¼ë°˜ì ìœ¼ë¡œ ë§ì´ ì‚¬ìš©ë˜ëŠ” ëª¨ë“ˆì˜ í™•ì¥ìë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
  moduleFileExtensions: [
    'js',
    'jsx',
    'json',
    'vue'
  ],
  // `@`ë‚˜ `~` ê°™ì€ ê²½ë¡œ ë³„ì¹­ì„ ë§¤í•‘í•©ë‹ˆë‹¤.
  // E.g. `import HelloWorld from '~/components/HelloWorld.vue';`
  // `<rootDir>` í† í°ì„ ì‚¬ìš©í•´ ë£¨íŠ¸ ê²½ë¡œë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  // TODO: í”„ë¡œì íŠ¸ì— ë§ëŠ” ê²½ë¡œë¡œ ìˆ˜ì •í•˜ì„¸ìš”!
  moduleNameMapper: {
    '^~/(.*)$': '<rootDir>/src/$1',
    '^@/(.*)$': '<rootDir>/src/$1'
  },
  // ì¼ì¹˜í•˜ëŠ” ê²½ë¡œì—ì„œëŠ” ëª¨ë“ˆì„ ê°€ì ¸ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤.
  // `<rootDir>` í† í°ì„ ì‚¬ìš©í•´ ë£¨íŠ¸ ê²½ë¡œë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  // TODO: í”„ë¡œì íŠ¸ì— ë§ëŠ” ê²½ë¡œë¡œ ìˆ˜ì •í•˜ì„¸ìš”!
  modulePathIgnorePatterns: [
    '<rootDir>/node_modules',
    '<rootDir>/build',
    '<rootDir>/dist'
  ],
  // ì •ê·œì‹ê³¼ ì¼ì¹˜í•˜ëŠ” íŒŒì¼ì˜ ë³€í™˜ ëª¨ë“ˆì„ ì§€ì •í•©ë‹ˆë‹¤.
  transform: {
    '^.+\\.vue$': 'vue-jest',
    '^.+\\.jsx?$': 'babel-jest'
  },
  // Jest Snapshot í…ŒìŠ¤íŠ¸ì— í•„ìš”í•œ ëª¨ë“ˆì„ ì§€ì •í•©ë‹ˆë‹¤.
  snapshotSerializers: [
    'jest-serializer-vue'
  ]
}
```



## Babel êµ¬ì„± ì˜µì…˜

`.babelrc` íŒŒì¼ í˜¹ì€, `babel.config.js` íŒŒì¼ì— ì„¤ì •. ì•„ë˜ëŠ” babel.config.jsì„.

```js
module.exports = {
  presets: ['@babel/preset-env']
}
```

í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ jestëŠ” `process.env.NODE_ENV` ê°€ ë¹„ì–´ìˆëŠ” ê²½ìš° ìë™ìœ¼ë¡œ `test` ë¥¼ ì§€ì •í•œë‹¤. ë”°ë¼ì„œ `env` [ë³‘í•© ì˜µì…˜](https://babeljs.io/docs/en/options#env)ì„ í†µí•´ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œë§Œ ë™ì‘í•  Babel êµ¬ì„±ì„ í•  ìˆ˜ ìˆìŒ.



## í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€

package.jsonì— ì¶”ê°€í•˜ì. ê·¸ëŸ¬ë©´ `run` í‚¤ì›Œë“œ ì—†ì´ `npm t` ë¥¼ í†µí•´ ë™ì‘ ê°€ëŠ¥.

```json
{
  "scripts": {
    "test": "jest"
  }
}
```

í˜¹ì€, `--watch` [Jest CLI ì˜µì…˜](https://jestjs.io/docs/en/cli#--watch)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.
ì´ëŠ” íŒŒì¼ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³  ë³€ê²½ëœ íŒŒì¼ê³¼ ê´€ë ¨ëœ í…ŒìŠ¤íŠ¸ë§Œ ë‹¤ì‹œ ì‹¤í–‰í•  ìˆ˜ ìˆì–´ í¸ë¦¬.



## window is not defined ì—ëŸ¬

ë§Œì•½ ìœ„ ì—ëŸ¬ë¥¼ ë§Œë‚œë‹¤ë©´, jsdom ê´€ë ¨ ì„¤ì •ì´ ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-07-08 á„‹á…©á„’á…® 7.52.36](/Users/hwangseontae/Desktop/á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-07-08 á„‹á…©á„’á…® 7.52.36.png)

```shell
$ npm i -D jsdom
```

í›„ì—, jest.config.js ì—,

```
"testEnvironment": "jsdom"
```

ì´ë ‡ê²Œ ë„£ì–´ì£¼ê³  npm t í•´ë³´ì. ë¨.