# JS 지원범위(폴리필)

CRA(create-react-app) 에서 ES6의 모든 기능을 지원한다. ES6 이후에 추가 되었어거 제안된 기능 중에서 CRA(v3.2.0) 에서 지원하는 기능은 다음과 같다.

- 지수 연산자(exponentiation operator)
- async / await 함수
- 나머지 연산자(rest operator), 전개 연산자(spread operator)
- 동적 임포트(dynamic import)
- 클래스 필드(class field)
- JSX 문법
- 타입스크립트(typescript), 플로(flow) 타입 시스템

CRA의 기본 설정에서는 아무런 폴리필(polyfill)도 포함되지 않는다.

---

📌 폴리필(Polyfill)이란?

ES6 등의 문법이 많이 바뀌면서 최신 버전의 Javascript를 지원하지 않는 브라우저가 다시 발생. 이 문제를 해결하기 위해 나온게 트랜스파일러(Transpiler, bable등), 폴리필(Polyfill) 이다.

폴리필은, 추가된 문법과 기능을 어느 브라우저 환경에서도 사용할 수 있도록 똑같이 구현해놓은 라이브러를 말함. Polyfill은 충전솜이라는 의미를 가지고 있음. 플러그인(추가기능)을 의미함.

---

<br/>

만약 CRA에서 ES8에 추가된 `String.padStart` 함수를 사용하고 싶다고 가정해보자. core-js 패키지를 사용하면 다양한 폴리필을 선택적으로 사용할 수 있다.

```sh
$ npm i core-js
```

그리고 다음과 같이 작성하면 폴리필이 추가된다.

```js
// index.js
import 'core-js/features/string/pad-start';

console.log('123'.padStart(5, '0'));   // 00123
```

index.js에서 한번만 가져오면 모든 곳에서 자유롭게 사용 가능. 바벨에서도 @babel/polyfill 혹은 @babel/preset-env 프리셋을 이용하면 폴리필을 추가할 수 있는데 @babel/polyfill 은 사용하지 않는 기능의 폴리필까지 모두 포함되기 때문에 번들 크기가 커지는 단점이 있음. @babel/preset-env 프리셋을 이용하면 필요한 폴리필만 추가할 수 있지만, 동적 타입 언어의 한계 때문에 core-js로 직접 추가하는 것보다는 몇 가지 불필요한 폴리필이 포함되는 단점이 있다.

<br/>

새로운 자바스크립트 표준이 나와도 대다수 사용자의 브라우저에서 지원하지 않으면 사용할 수 없다. 그래도 바벨을 이용하면 어느정도 사용 가능. 바벨을 사용하면 빌드 시점에 코드가 변환된다.

하지만, 새로운 객체나 함수는 성격이 조금 다르다. 물론 새로운 객체나 함수로 작성한 코드도 빌드 시점에 변환할 수 있다. 하지만 이들은 실행 시점에 주입할 수 있다는 장점이 있음. 따라서 실행 시점에 주입하고자 하는 객체나 함수가 현재 환경에 존재하는지 검사해서 존재하지 않는 경우에만 주입하는 게 좋다. 이렇게 기능이 존재하는지 검사해서 그 기능이 없을 때만 주입하는 것을 폴리필이라고 한다.

