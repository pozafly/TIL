# On-demand ISR

ê¸°ì¡´ ISRì€ ì‹œê°„ìœ¼ë¡œ SSG ë¥¼ ìƒì„±í•¨.

í•˜ì§€ë§Œ, ëˆ„ê°€ ê²Œì‹œê¸€ì„ ì˜¬ë ¸ì„ ë•Œ, ISRì— ì„¤ì •ëœ ì‹œê°„ ì´í›„ì—ë‚˜ ì›¹ì— ë³´ì—¬ì§€ê²Œ ëœë‹¤.

![[assets/images/571ab475ed411f28fc41dc306b8f40a5_MD5.png]]

ì‹œê°„ ì„¤ì •ì€ ê¸¸ ìˆ˜ë¡ ì‚¬ìš©ìê°€ ë³´ëŠ” ì†ë„ê°€ ëŠë ¤ì§€ê³  ì§§ì„ ìˆ˜ë¡ ë¶ˆí•„ìš”í•˜ê²Œ SSGë¥¼ ì¬ìƒì„±í•˜ê²Œ ëœë‹¤. ê·¸ëŸ¬ë©´ ì°¨ë¼ë¦¬ SSRì´ ë‚«ì§€ ì•ŠëŠëƒ? ë§ìŒ. í•˜ì§€ë§Œ SSRë„ ì—¬ì „íˆ ìš”ì²­ì‹œ ì„œë²„ì—ì„œ JSë¥¼ í†µí•´ ì •ì  ìƒì„±ì„ ê³„ì† í•˜ê³  ìˆê¸° ë•Œë¬¸ì— ì‚¬ìš©ìê°€ htmlì„ ë°›ëŠ”ê²Œ ëŠë¦¬ë‹¤ê³ ë„ ë³¼ ìˆ˜ ìˆìŒ.

ê·¸ ë•Œ on-demand ISR ë°©ì‹ì´ ë‚˜ì˜¤ê²Œ ëœë‹¤. (ìš”ì²­ì„ ë°›ì„ ë•Œë§ˆë‹¤ í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ìƒì„±í•˜ëŠ” ë°©ì‹)

íŠ¹ì • ì‹œì  triggerê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ SSGë¥¼ ë§Œë“œëŠ” ë°©ì‹ì´ë‹¤.

![[assets/images/4727d683f364e129088ca4087729786d_MD5.png]]

---

## ë§Œë“¤ê¸°
```js
export const getStaticProps = async () => {
  const [allBooks, recoBooks] = await Promise.all([
    fetchBooks(),
    fetchRandomBooks(),
  ]);
  
  return {
    props: {
      allBooks,
      recoBooks,
    },
    revalidate: 3, // 3ì´ˆ ISR
  };
};
```
ì—¬ê¸°ì„œ `revalidate` ë¥¼ ì œê±°í•˜ê³  `api routes` ë¥¼ ìƒì„±í•œë‹¤.

pages/api/revalidate.ts ë¥¼ ë§Œë“¤ì.
```js
export default async function handler(
	req: NextApiRequest,
 	res: NextApiResponse,
) {
  try {
    await res.revalidate("/"); // ğŸ„â€â™‚ï¸
    return res.json({ revalidate: true });
  } catch (err) {
    res.status(500).send('Revalidation Failed');
  }
}
```
ğŸ„â€â™‚ï¸ ì´ ë¶€ë¶„ì€ ì–´ë–¤ í˜ì´ì§€ë¥¼ revalidate í•˜ë ¤ê³  í•˜ëŠ”ì§€ ê²½ë¡œë¥¼ ì ì–´ì£¼ëŠ” ê²ƒì´ë‹¤.

ì´ë ‡ê²Œ ë˜ì—ˆì„ ê²½ìš° `localhost:3000/api/revalidate` ë¡œ api í˜¸ì¶œì„ ë³´ë‚´ë©´ í•´ë‹¹ í˜ì´ì§€ê°€ revalidate ë˜ë„ë¡ ëœë‹¤.
